# pagereport

政府会議ページのサマリー作成スキル（HTML+PDF対応、トークン最適化）

## 概要

このプロジェクトは、日本の政府会議ページから構造化されたサマリーを生成する Claude Code スキルです。HTMLページとPDFドキュメントの両方に対応し、会議資料を分析して2種類の出力ファイルを生成します。

## 出力ファイル

1. **サマリーファイル** (`*_summary.txt`): 1,000文字の要約 + 資料リスト + リンク
2. **詳細ファイル** (`*_detail.md`): 最大10,000文字の包括的レポート

## 使い方

```bash
# URLを指定してスキルを実行（HTMLページまたはPDF）
/pagereport "https://www.cas.go.jp/jp/seisaku/nipponseichosenryaku/kaigi/dai2/gijisidai.html"
```

## 主な機能

- **自動メタデータ抽出**: 会議名、日付（YYYYMMDD形式に変換）、回数、開催場所を自動抽出
- **PDF優先度付けシステム**: 関連性、重要性、文書タイプに基づいてPDFをスコアリング（1-5）
- **文書タイプ検出**: Word、PowerPoint、議事次第、名簿、報道発表、調査、その他の7カテゴリで自動判別
- **トークン最適化**: ページ数に応じた動的な読み取り戦略
  - ≤5ページ: 全文読み取り
  - ≤20ページ: 目次 + 重要セクション
  - ≤50ページ: 目次 + 要約 + 結論
  - >50ページ: メタデータ + 目次 + 要約のみ

## 出力形式

### サマリーファイル構造（論文形式）

1. 背景・文脈（2-3文）- **会議名と回数を含む**
2. 目的（1-2文）
3. 議論内容（3-5文）
4. 決定事項・合意事項（3-5文）
5. 今後の方向性（2-3文）

単一段落、最大1,000文字、事実のみ（推測なし）
URLは要約段落の直後に新しい行で記載

### ファイル配置

```
output/
├── {会議名}_{YYYYMMDD}_第{N}回_summary.txt
└── {会議名}_{YYYYMMDD}_第{N}回_detail.md
```

例:
```
output/
├── 日本成長戦略会議_20251224_第2回_summary.txt
└── 日本成長戦略会議_20251224_第2回_detail.md
```

## アーキテクチャ

### 処理パイプライン（9ステップ）

1. コンテンツ取得: WebFetchでHTML取得、またはローカル/リモートPDF読み取り
2. メタデータ抽出: 会議名、日付、回数、場所を自動抽出
3. 文書タイプ検出: PDFを7カテゴリでスコアリング
4. 会議概要作成: HTMLまたは議事次第PDFから抽出
5. 議事録参照: 実際の発言内容を探索
6. 資料の選択的読み取り: 関連性でPDFをスコアリング、優先度の高いファイルをcurlで`/tmp/`にダウンロード
7. タイプ別読み取り: 文書タイプとページ数に基づいた最適化戦略を適用
8. サマリー生成: 構造化された要約（1,000文字、5要素構造）+ 詳細レポート作成
9. ファイル出力: `output/`ディレクトリに書き込み

## 技術仕様

- **プログラミング言語**: Claude Code スキル（Markdown形式）
- **対応サイト**: 主に www.cas.go.jp（事前承認済み）
- **権限設定**: `.claude/settings.local.json`で設定済み
  - `WebFetch(domain:www.cas.go.jp)`
  - `Bash(curl:*)`
  - `Bash(mkdir:*)`
  - `Bash(ls:*)`

## プロジェクト構成

```
.
├── .claude/
│   ├── commands/
│   │   └── pagereport.md        # スキル定義（9ステップワークフロー）
│   └── settings.local.json      # 権限設定
├── CLAUDE.md                     # Claude Code向けガイダンス
├── README.md                     # このファイル
└── output/                       # 生成されたサマリーファイル（.gitignoreで除外）
```

## 開発

スキル定義を編集する場合（`.claude/commands/pagereport.md`）:

- 9ステップ構造を維持
- 異なる文書タイプを処理する場合はトークン最適化戦略を更新
- 観察された関連性パターンに基づいてPDFスコアリング基準を調整
- 要約構造を厳密に保持（5要素、1段落、1,000文字）
- 実際の政府会議ページでテストして変更を検証

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。
